CREATE AGGREGATE FUNCTION TotalSum(x INT)  RETURNS INT
BEGIN
	DECLARE total INT DEFAULT 0;
	DECLARE CONTINUE HANDLER FOR SQLSTATE '02000' RETURN total;
	LOOP 
		FETCH GROUP NEXT ROW;
		SET total=total+x;
	END LOOP;
END

create table t1 (name VARCHAR(20) ,sal int(10));
INSERT INTO t1 (name, sal) VALUES ('John', 1000);
INSERT INTO t1 (name, sal) VALUES ('Varun', 2000);
INSERT INTO t1 (name, sal) VALUES ('Doe', 3000);
INSERT INTO t1 (name, sal) VALUES ('Alex', 900);
INSERT INTO t1 (name, sal) VALUES ('Bob', 500);
select TotalSum(sal) from t1;
DROP FUNCTION TotalSum;
drop table t1;

